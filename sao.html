<!DOCTYPE html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>æŸ¥è¯¢ç³»ç»Ÿ</title>
<style>
  * {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  }

  body {
    max-width: 480px;
    margin: 40px auto;
    padding: 0 20px;
    background: #f5f7fa;
  }

  .card {
    background: white;
    padding: 30px 24px;
    border-radius: 20px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.08);
  }

  h3 {
    font-size: 20px;
    margin-bottom: 16px;
    color: #111;
  }

  input {
    width: 100%;
    padding: 14px 16px;
    border: 1px solid #ddd;
    border-radius: 12px;
    font-size: 16px;
    margin-bottom: 12px;
    outline: none;
    transition: border 0.2s;
  }

  input:focus {
    border-color: #007bff;
  }

  button {
    width: 100%;
    padding: 14px;
    background: #007bff;
    color: white;
    border: none;
    border-radius: 12px;
    font-size: 16px;
    font-weight: 500;
    cursor: pointer;
    transition: background 0.2s;
  }

  button:hover {
    background: #0066dd;
  }

  .result-box {
    margin-top: 24px;
  }

  textarea {
    width: 100%;
    padding: 16px;
    border: 1px solid #eee;
    border-radius: 12px;
    background: #fafbfc;
    font-size: 16px;
    resize: none;
    outline: none;
    min-height: 80px;
  }
</style>

<div class="card">
  <h3>æŸ¥è¯¢</h3>
  <input id="input" placeholder="è¾“å…¥å†…å®¹" value="123">
  <button onclick="go()">æŸ¥è¯¢</button>

  <div class="result-box">
    <h3>ç»“æœ</h3>
    <textarea id="out" readonly placeholder="ç­‰å¾…æŸ¥è¯¢..."></textarea>
  </div>
</div>

<script>
// ==============================================
// ğŸ”’ ç®¡ç†å‘˜å¯†é’¥ï¼ˆä¸åŠ¨ï¼‰
// ==============================================
const SEND_KEY = "123456789.abc.cbd";
const BACK_KEY = "987654321.cbd.abc";

// ==============================================
// ğŸ“ B.html åœ°å€ï¼ˆä¸åŠ¨ï¼‰
// ==============================================
const B_URL = "ls.html";

// ==============================================
// åŠ å¯†è§£å¯†ï¼ˆå®Œå…¨ä¸å˜ï¼‰
// ==============================================
function xorEncrypt(str, key) {
  let r = "";
  for (let i=0; i<str.length; i++) {
    const kc = key.charCodeAt(i % key.length);
    const sc = str.charCodeAt(i);
    r += String.fromCharCode(sc ^ kc);
  }
  return btoa(encodeURIComponent(r));
}

function xorDecrypt(enc, key) {
  try {
    const d = decodeURIComponent(atob(enc));
    let r = "";
    for (let i=0; i<d.length; i++) {
      const kc = key.charCodeAt(i % key.length);
      const dc = d.charCodeAt(i);
      r += String.fromCharCode(dc ^ kc);
    }
    return r;
  } catch(e) {
    return "è§£å¯†å¤±è´¥";
  }
}

// ==============================================
// åªæ˜¾ç¤ºæœ€ç»ˆç»“æœ
// ==============================================
async function go() {
  const t = document.getElementById("input").value;
  const out = document.getElementById("out");
  out.value = "æ­£åœ¨æŸ¥è¯¢...";

  try {
    const enc = xorEncrypt(t, SEND_KEY);
    const res = await fetch(B_URL);
    const txt = await res.text();

    const reg = /"([^"]+)"\s*=\s*"([^"]+)"/g;
    let m, result = "æœªæ‰¾åˆ°åŒ¹é…é¡¹";

    while ((m = reg.exec(txt)) !== null) {
      if (m[1] === enc) {
        result = xorDecrypt(m[2], BACK_KEY);
        break;
      }
    }

    out.value = result;
  } catch (e) {
    out.value = "æŸ¥è¯¢å¤±è´¥";
  }
}
</script>
